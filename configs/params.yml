seed: 7
hvg_n_top_genes: 2000

spec:
  n_pcs: 20
  dcol_max_cells: 3000
  ari_label_key: "Cell type annotation"   # <-- must match an obs column name
  ari_n_dims: 10                          # how many dims to use for ARI per embedding
  ad_file: data/interim/weinreb.h5ad

qc:
  min_cells: 500
  min_genes: 200
  max_pct_mt: 15

eggfm_model:
  hidden_dims: [512, 512, 512, 512]
  latent_dim: 64

eggfm_train:
  batch_size: 2048
  num_epochs: 150
  lr: 4.0e-4
  sigma: 1.0
  device: "cuda"
  latent_space: "hvg"
  early_stop_patience: 30
  early_stop_min_delta: 0.0
  n_cells_sample: 1000000

eggfm_diffmap:
  geometry_source: "pca"        # "pca" or "hvg"
  energy_source: "hvg"          # where SCM/Hessian read energies
  metric_mode: "scm"      # "euclidean", "scm", or "hessian_mixed"
  n_neighbors: 30
  n_comps: 30
  device: "cuda"
  hvp_batch_size: 1024
  eps_value: 1.0
  eps_trunc: "yes"
  distance_power: 1.0
  t: 0.5
  norm_type: "l1"

  # SCM hyperparams
  metric_gamma: 0.4
  metric_lambda: 4.0
  energy_clip_abs: 2.0
  energy_batch_size: 2048

  # Hessian mixing hyperparams
  hessian_mix_mode: "none"      # "additive" | "multiplicative" | "none"
  hessian_mix_alpha: 0.3
  hessian_beta: 0.2
  hessian_clip_std: 2.0
  hessian_use_neg: true
